      else // geen BUFR en niet compressed
      {
         samenstellen_te_verzenden_obs();

         //
         // emailsettings_file
         //
         volledig_emailsettings_path = turbowin_dir + email_sub_dir + email_settings_file;
         is.open(volledig_emailsettings_path.c_str(), ios::in);
         if (is)
         {
            do // while (!is.eof());
            {
               record.read_line(is);
               if (record.substr(0, 20) == text_toaddress)
               {
                  if (record.length() >= 20)
                     linkto = record.substr(20);
               } // if (record.substr(0, 20) == text_toaddress)
               else if (record.substr(0, 20) == text_subject)
               {
                  if (record.length() >= 20)
                  {
                     /* NB als er ddhhmm in staat dan bij compressed NIET substitueren met echte dag-uur-minuut (kan niet uit obs gehaald worden)*/

                     linksubject = record.substr(20);

                     if (linksubject == "")                    // b.v. outlook kan niet tegen een leeg object field by : "?subject="
                        linksubject = "obs";

                  } // if (record.length() >= 20)
               } // else if (record.substr(0, 20) == text_subject)

            } while (!is.eof());

            is.close();

            /* NB met AMOS mail info wordt bij compressed niets gedaan */


            /* parameter string opbouwen */
            link = "mailto:";
            link += linkto;
            link += "?subject=";
            link += linksubject;
            link += "&body=";
            link += string(char_obs_1);            // b.v. bij outlook 98 komt de newline niet goed over
            link += obs_new_line;                  // new-line
            link += string(char_obs_2);

            /* NB bij compressed geen nationale groepen toevoegen mogelijk */

            /* reminder dat het in plain text verstuurd moet worden */
            info = "";
            info = "The observation message must be sent as plain text only. ";
            info += "Make sure that an HTML option is switched off in your E-mail program";
            MessageBox(info.c_str(), "TurboWin reminder \"plain text\"", MB_OK | MB_ICONINFORMATION);

            /* E-mail programma activeren */
            MenuEmailLink2 -> Open(link);

            // Windows 2000, XP ?
            win_ver_2000_xp_ok = Check_Windows_Version();

            // internet via Modem en telefoon line (dial-up connection) ?
            if (win_ver_2000_xp_ok == true)
               modem_con_ok = Check_Modem_Phone_Line_Connection();

            if (modem_con_ok == true)    // dus dan: windows 2000/xp met een modem phone line internet verbinding
            {
               info = "(after you chose the 'Send' command) \n please ensure that the observation has been sent, \n in other words not queued in the mail outbox";
               MessageBox(info.c_str(), "Turbowin mesage", MB_OK | MB_ICONINFORMATION);
            }

            /* naar immt log */
            IMMT_log();                               // vullen IMMT log

            /* bepalen grootte (in bytes) van IMMT log (+ eventueel advies om te 'moven') */
            Test_IMMT_grootte();

            /* naar logbook code file (voor private use, not for Met Service) */
            Code_Log();

            /* eventueel updaten van de statistics (als ze op het scherm staan) */
            if (StatisticsObserver_aangevraagd == TRUE)
            {
               /* bij ingaan CmOptionsStatisticsObserver() wordt         */
               /* StatisticsObserver_aangevraagd het 'tegenoversgestelde */
               /* i.v.m. vinken (dus hij was er normaal niet en na de    */
               /* aanvraag wel, hier was hij er wel en moet hij blijven  */
               StatisticsObserver_aangevraagd = FALSE;
               CmOptionsStatisticsObserver();
            } // if (StatisticsObserver_aangevraagd == TRUE)

            Observation_Complete_Message(output_sort);
            /* N.B. voor geven messagebox met complete message text                              */
            /* werkt dit niet goed omdat via OLE het geregistreerde mail programma is opgestard  */
            /* en direct wordt de message complete gegeven (zonder dat je wat hebt verzonden)    */
            /* wordt echter aangeroepn voor instellen timer */

         } // if (is)
         else // file not open
         {
            info = "";
            info = "Unable to open TurboWin E-mail settings file (";
            info += volledig_emailsettings_path;
            info += ").";
            info += " Please select: Maintenance | E-mail settings.";
            ::MessageBox(0, info.c_str(), "TurboWin error", MB_OK | MB_ICONERROR);
         } // else (file not open)
      } // else (geen BUFR en niet compressed)
		I
